compose:
  - call: lcod://tooling/registry_catalog/collect@0.1.0
    in:
      rootPath: $.rootPath
      catalogPath: $.catalogPath
    out:
      collectedPackagesJsonl: packagesJsonl
      collectedRegistryJson: registryJson
      collectedPackages: packages
      collectWarnings: warnings
  - call: lcod://tooling/registry_catalog/validate@0.1.0
    in:
      rootPath: $.rootPath
      catalogPath: $.catalogPath
    out:
      validationErrors: errors
      validationPackages: packages
  - call: lcod://tooling/value/default_array@0.1.0
    in:
      value: $.collectWarnings
      fallback: []
    out:
      collectWarnings: resolved

  - call: lcod://tooling/value/default_array@0.1.0
    in:
      value: $.validationErrors
      fallback: []
    out:
      validationErrors: resolved
  - call: lcod://impl/set@1
    in:
      packagesJsonl: $.collectedPackagesJsonl
      registryJson: $.collectedRegistryJson
      packages: $.collectedPackages
      warnings: $.collectWarnings
      errors: $.validationErrors
      validation: $.validationPackages
    out:
      packagesJsonl: packagesJsonl
      registryJson: registryJson
      packages: packages
      warnings: warnings
      errors: errors
      validation: validation
